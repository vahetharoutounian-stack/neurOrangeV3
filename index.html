# This packaged version of the Nickelodeon audio player removes the track emojis and the
# horizontal volume sliders that previously appeared when a track was playing.  The
# overall pillâ€‘shaped tray, bubble toggle, stop button and sprout buttons remain
# unchanged so the UI behaves exactly the same, but without the glyph swap or the
# intrusive volume bars.  This file is based off of the existing `index (2).html`
# provided in the repo and has been modified so that track buttons always display
# the sprout icon and volume sliders remain hidden at all times.

<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Nickelodeon Audio Player</title>
<style>
  :root {
    /* Nickelodeon orange palette for rim */
    --nick: #FF6600;
    --nick2: #FF3B00;
    /* Bergamot palette for toggle fill */
    --berg-a: #ffeca7;
    --berg-b: #ffd45c;
  }
  html, body { height: 100%; margin: 0; }
  body { background:#0f0f11; color:#fff; font:15px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; }

  /* Tray container anchored bottom-left. Same spacing collapsed or expanded. */
  #dock {
    position: fixed;
    left: calc(12px + env(safe-area-inset-left));
    bottom: calc(12px + env(safe-area-inset-bottom));
    z-index: 2147483647;
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 14px;
    border-radius: 999px;
    background: linear-gradient(135deg, var(--nick), var(--nick2));
    color: #fff;
    border: 1px solid rgba(0,0,0,0.35);
    box-shadow: 0 8px 20px rgba(255,102,0,0.32);
    -webkit-user-select: none;
    user-select: none;
  }
  /* When collapsed, hide all elements marked hideable. Do not adjust spacing to keep scale consistent */
  #dock.collapsed .hideable {
    display: none !important;
  }

  /* Nickelodeon bubble for the toggle button */
  .bubble {
    position: relative;
    width: 46px;
    height: 46px;
    border: none;
    background: transparent;
    cursor: pointer;
    padding: 0;
    outline: none;
  }
  .bubble::before {
    content: "";
    position: absolute;
    inset: -2px;
    border-radius: 999px;
    background: linear-gradient(135deg, var(--nick), var(--nick2));
    box-shadow: 0 6px 16px rgba(0,0,0,0.35);
  }
  .bubble .inner {
    position: absolute;
    inset: 5px;
    border-radius: 999px;
    /* Bergamot radial fill */
    background: radial-gradient(60% 60% at 35% 25%, #fff6c2 0%, var(--berg-a) 40%, var(--berg-b) 100%);
  }
  .bubble .glyph {
    position: relative;
    z-index: 2;
    font-size: 22px;
    line-height: 46px;
    display: block;
    text-align: center;
  }

  /* Generic orb button for stop and tracks */
  .orb {
    width: 42px;
    height: 42px;
    border-radius: 999px;
    display: grid;
    place-items: center;
    font-size: 20px;
    font-weight: 900;
    background: rgba(0,0,0,0.18);
    border: 1px solid rgba(0,0,0,0.35);
    cursor: pointer;
    position: relative;
    transition: opacity 0.18s ease, width 0.18s ease, margin 0.18s ease;
  }
  .badge {
    position: absolute;
    right: -6px;
    top: -6px;
    font-size: 12px;
    background: #111;
    border-radius: 6px;
    padding: 0 4px;
  }
  .glyph { pointer-events: none; }

  /* Sliders are hidden permanently in this version. */
  .nub {
    display: none !important;
    width: 96px;
    accent-color: #fff;
  }
  @media (min-width: 720px) {
    .nub {
      /* Sliders remain hidden */
    }
  }

  /* First-tap overlay used to unlock audio on iOS */
  #startOverlay {
    position: fixed;
    inset: 0;
    background: #000;
    opacity: 0.85;
    z-index: 2147483646;
    display: flex;
    align-items: center;
    justify-content: center;
  }
  #startOverlay button {
    background: linear-gradient(135deg, var(--nick), var(--nick2));
    border: 4px solid #fff;
    border-radius: 50%;
    width: 100px;
    height: 100px;
    font-size: 64px;
    line-height: 1;
    cursor: pointer;
  }
</style>
</head>
<body>

  <!-- Separate audio elements, one per track. Loops enabled. -->
  <audio id="a_sparkle" loop preload="metadata" playsinline>
    <source src="tracks/sparkle.mp3" type="audio/mpeg" />
    <source src="tracks/sparkle.m4a" type="audio/mp4" />
  </audio>
  <audio id="a_orange" loop preload="metadata" playsinline>
    <source src="tracks/orange.mp3" type="audio/mpeg" />
    <source src="tracks/orange.m4a" type="audio/mp4" />
  </audio>
  <audio id="a_autumn" loop preload="metadata" playsinline>
    <source src="tracks/autumn.mp3" type="audio/mpeg" />
    <source src="tracks/autumn.m4a" type="audio/mp4" />
  </audio>
  <audio id="a_storm" loop preload="metadata" playsinline>
    <source src="tracks/storm.mp3" type="audio/mpeg" />
    <source src="tracks/storm.m4a" type="audio/mp4" />
  </audio>
  <audio id="a_negin" loop preload="metadata" playsinline>
    <source src="tracks/negin.mp3" type="audio/mpeg" />
    <source src="tracks/negin.m4a" type="audio/mp4" />
  </audio>

  <!-- Overlay to require a user gesture before audio can play on some mobile browsers -->
  <div id="startOverlay"><button id="startBtn" aria-label="Start">ðŸŸ§</button></div>

  <!-- Audio control tray. Initially collapsed; content hidden with CSS. -->
  <div id="dock" class="collapsed" role="group" aria-label="Audio controls">
    <!-- Toggle button: expands/collapses tray without affecting playback -->
    <button id="b_toggle" class="bubble" aria-label="Toggle">
      <span class="inner"></span><span class="glyph">ðŸŸ¡</span>
    </button>
    <!-- Stop button: stops all tracks and collapses tray -->
    <button id="b_stop" class="orb" aria-label="Stop / Reset">ðŸŸ§</button>
    <!-- Track buttons (the sliders remain hidden) -->
    <!-- Sparkle -->
    <button id="b_sparkle" class="orb hideable" aria-label="Sparkle"><span class="glyph">ðŸŒ±</span><span id="e_sparkle" class="badge"></span></button>
    <!-- Orange -->
    <button id="b_orangeTr" class="orb hideable" aria-label="Orange"><span class="glyph">ðŸŒ±</span><span id="e_orange" class="badge"></span></button>
    <!-- Autumn -->
    <button id="b_autumn" class="orb hideable" aria-label="Autumn"><span class="glyph">ðŸŒ±</span><span id="e_autumn" class="badge"></span></button>
    <!-- Storm -->
    <button id="b_storm" class="orb hideable" aria-label="Storm"><span class="glyph">ðŸŒ±</span><span id="e_storm" class="badge"></span></button>
    <!-- Negin -->
    <button id="b_negin" class="orb hideable" aria-label="Negin"><span class="glyph">ðŸŒ±</span><span id="e_negin" class="badge"></span></button>
  </div>

<script>
(() => {
  const dock    = document.getElementById('dock');
  const btnToggle = document.getElementById('b_toggle');
  const btnStop   = document.getElementById('b_stop');
  // Track definitions
  // Each track is exclusive except storm (concurrent) and has a seed button only; emojis are unused now.
  const tracks = [
    { id:'sparkle', emoji:'âœ¨', a:document.getElementById('a_sparkle'), b:document.getElementById('b_sparkle'), e:document.getElementById('e_sparkle'), exclusive:true },
    { id:'orange',  emoji:'ðŸŠ', a:document.getElementById('a_orange'),  b:document.getElementById('b_orangeTr'), e:document.getElementById('e_orange'),  exclusive:true },
    { id:'autumn',  emoji:'ðŸ‚', a:document.getElementById('a_autumn'),  b:document.getElementById('b_autumn'),  e:document.getElementById('e_autumn'),  exclusive:true },
    { id:'storm',   emoji:'â›ˆï¸', a:document.getElementById('a_storm'),   b:document.getElementById('b_storm'),   e:document.getElementById('e_storm'),   exclusive:false },
    { id:'negin',   emoji:'ðŸ’«', a:document.getElementById('a_negin'),   b:document.getElementById('b_negin'),   e:document.getElementById('e_negin'),   exclusive:true }
  ];
  // Loudness multipliers per track (optional; you can tweak these)
  const boosts = { sparkle:2.0, storm:3.0, orange:1.0, autumn:1.0, negin:1.0 };
  // Helpers
  // Reset the glyph on a button to the sprout; in this version we never swap to emoji.
  const seed = (btn) => { const g = btn.querySelector('.glyph'); if (g) g.textContent = 'ðŸŒ±'; };
  // Show a badge on top of a button for warnings (e.g. missing audio)
  const badge = (el, msg) => { el.textContent = msg||''; if (msg) setTimeout(() => { el.textContent = ''; }, 1500); };
  // Apply volume boost (we keep audio volume fixed here since sliders are removed)
  const applyVolume = (t) => {
    const raw = 1.0;
    t.a.volume = Math.min(1, raw * (boosts[t.id] || 1));
  };
  // Initialize
  tracks.forEach(t => {
    seed(t.b);
    applyVolume(t);
  });
  function stop(t) {
    try { t.a.pause(); } catch (e) {}
    seed(t.b);
  }
  async function start(t) {
    if (t.exclusive) {
      tracks.forEach(x => { if (x !== t && x.exclusive && !x.a.paused) stop(x); });
    }
    try { t.a.currentTime = 0; } catch (e) {}
    seed(t.b);
    try {
      await t.a.play();
    } catch (err) {
      seed(t.b);
      badge(t.e,'âš ï¸');
    }
  }
  // Wire events for each track
  tracks.forEach(t => {
    t.b.addEventListener('click', () => {
      if (t.a.paused) {
        start(t);
      } else {
        stop(t);
      }
    }, { passive: true });
    // No volume slider events because sliders are removed
    t.a.addEventListener('ended', () => { seed(t.b); });
    t.a.addEventListener('pause', () => {
      if (!t.a.ended) {
        seed(t.b);
      }
    });
  });
  // Toggle collapse/expand
  btnToggle.addEventListener('click', () => {
    dock.classList.toggle('collapsed');
  }, { passive: true });
  // Stop all and collapse
  btnStop.addEventListener('click', () => {
    tracks.forEach(stop);
    dock.classList.add('collapsed');
  }, { passive: true });
  // iOS audio unlock
  function unlockIOS() {
    if (unlockIOS.done) return;
    unlockIOS.done = true;
    const prev = tracks.map(t => ({ muted: t.a.muted, vol: t.a.volume }));
    tracks.forEach(t => { t.a.muted = true; t.a.volume = 0; });
    Promise.all(tracks.map(t => {
      try { t.a.play().catch(() => {}); } catch (e) {}
      return new Promise(resolve => setTimeout(resolve, 60));
    })).then(() => {
      tracks.forEach((t,i) => {
        try { t.a.pause(); } catch (e) {}
        t.a.currentTime = 0;
        t.a.muted = prev[i].muted;
        applyVolume(t);
      });
    });
  }
  window.addEventListener('pointerdown', unlockIOS, { once:true, passive:true });
  window.addEventListener('touchend',   unlockIOS, { once:true, passive:true });
  window.addEventListener('click',      unlockIOS, { once:true, passive:true });
  // First user gesture: hide overlay and auto start sparkle track
  const overlay = document.getElementById('startOverlay');
  overlay.addEventListener('click', () => {
    overlay.style.display = 'none';
    dock.classList.remove('collapsed');
    const sparkleTrack = tracks.find(x => x.id === 'sparkle');
    start(sparkleTrack);
  }, { once:true, passive:true });
})();
</script>
</body>
</html>
